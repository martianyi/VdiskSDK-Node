{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nconst fs = require('fs');\nconst querystring = require('querystring');\nconst request = require('request');\n\n/**\n * oauth2 client\n */\nclass OAuth2 {\n\n    /**\n     * Constructor\n     * @param app_key\n     * @param app_secret\n     * @param call_back_url\n     */\n    constructor(app_key, app_secret, call_back_url) {\n        this.version = '0.1.0';\n        this.ACCESS_TOKEN_URL = \"https://auth.sina.com.cn/oauth2/access_token\";\n        this.AUTHORIZE_URL = \"https://auth.sina.com.cn/oauth2/authorize\";\n        this.app_key = app_key;\n        this.app_secret = app_secret;\n        this.call_back_url = call_back_url;\n    }\n\n    /**\n     * Get the authorization url\n     * @param response_type\n     * @param display: default|mobile|popup\n     * @param state\n     * @returns {string}\n     */\n    authorize({response_type = \"code\", display = \"default\", state = \"\"}={}) {\n        let data = {\n            \"client_id\": this.app_key,\n            \"redirect_uri\": this.call_back_url,\n            \"response_type\": response_type,\n            \"display\": display\n        };\n        if (state.length > 0) {\n            data[\"state\"] = state\n        }\n        return this.AUTHORIZE_URL + \"?\" + querystring.stringify(data);\n    }\n\n    /**\n     * Get access token\n     * @param grant_type = authorization_code|refresh_token\n     * @param code\n     * @param refresh_token\n     * @param cb\n     */\n    accessToken({grant_type = \"authorization_code\", code = \"\", refresh_token = \"\"}={}, cb) {\n        let data = {\n            \"client_id\": this.app_key,\n            \"client_secret\": this.app_secret,\n            \"grant_type\": grant_type\n        };\n        if (grant_type === \"authorization_code\") {\n            data[\"code\"] = code;\n            data[\"redirect_uri\"] = this.call_back_url\n        }\n        else if (grant_type == \"refresh_token\") {\n            data[\"refresh_token\"] = refresh_token\n        }\n        const url = this.ACCESS_TOKEN_URL;\n        request.post({\n            url: url,\n            form: data\n        }, function (err, resp, body) {\n            if (err) return cb(new Error('请求失败: ' + err));\n            // handle server errors\n            if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n                return cb(new Error('服务器内部错误: (' + resp.statusCode + ') ' + body));\n            }\n            var response = JSON.parse(body);\n            if (response.code) {\n                return cb(new Error(`请求失败: (${response.code}) ${response.msg}`))\n            } else {\n                return cb(null, response);\n            }\n        })\n    }\n}\n\n/**\n * vdisk client\n */\nclass Client {\n\n    /**\n     * Constructor\n     * @param root = sandbox | basic\n     */\n    constructor(root = \"sandbox\") {\n        this.version = '0.1.0';\n        this.API_URL = 'https://api.weipan.cn/2/';\n        this.WEIBO_URL = 'https://api.weipan.cn/weibo/';\n        this.UPLOAD_HOST = 'upload-vdisk.sina.com.cn';\n        this.CONTENT_SAFE_URL = 'https://' + this.UPLOAD_HOST + '/2/';\n        this.root = root;\n    }\n\n    /**\n     * Get account info\n     * @param access_token\n     * @param cb\n     */\n    accountInfo(access_token, cb) {\n        request({\n            url: this.API_URL + 'account/info',\n            headers: {\n                'Authorization': 'OAuth2 ' + access_token\n            }\n        }, function (err, resp, body) {\n            if (err) return cb(new Error('请求失败: ' + err));\n            // handle server errors\n            if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n                return cb(new Error('服务器内部错误: (' + resp.statusCode + ') ' + body));\n            }\n            var response = JSON.parse(body);\n            if (response.code) {\n                return cb(new Error(`请求失败: (${response.code}) ${response.msg}`))\n            } else {\n                return cb(null, response);\n            }\n        })\n    }\n\n    /**\n     * Meta data\n     * @param access_token\n     * @param path\n     * @param cb\n     */\n    metadata({access_token, path=''}={}, cb) {\n        request({\n            url: this.API_URL + 'metadata/' + this.root + '/' + path,\n            headers: {\n                'Authorization': 'OAuth2 ' + access_token\n            }\n        }, function (err, resp, body) {\n            if (err) return cb(new Error('请求失败: ' + err));\n            // handle server errors\n            if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n                return cb(new Error('服务器内部错误: (' + resp.statusCode + ') ' + body));\n            }\n            var response = JSON.parse(body);\n            if (response.error_code) {\n                return cb(new Error(`请求失败: ${response.error}`))\n            } else {\n                return cb(null, response);\n            }\n        })\n    }\n\n    /**\n     * Delta\n     * @param access_token\n     * @param cursor\n     * @param cb\n     */\n    delta({access_token, cursor=''}={}, cb) {\n        let param = {},\n            url = this.API_URL + 'delta/' + this.root;\n        if (cursor.length > 0) {\n            param['cursor'] = cursor;\n            url += '?' + querystring.stringify(param);\n        }\n        request.post({\n            url: url,\n            headers: {\n                'Authorization': 'OAuth2 ' + access_token\n            }\n        }, function (err, resp, body) {\n            if (err) return cb(new Error('请求失败: ' + err));\n            // handle server errors\n            if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n                return cb(new Error('服务器内部错误: (' + resp.statusCode + ') ' + body));\n            }\n            var response = JSON.parse(body);\n            if (response.error_code) {\n                return cb(new Error(`请求失败: ${response.error}`))\n            } else {\n                return cb(null, response);\n            }\n        })\n    }\n\n    /**\n     * Get files\n     * @param access_token\n     * @param path\n     * @param rev\n     * @param cb\n     */\n    files({access_token, path='', rev = ''}={}, cb) {\n        let param = {},\n            url = this.API_URL + 'files/' + this.root + \"/\" + path;\n        if (rev.length > 0) {\n            param['rev'] = rev;\n            url += '?' + querystring.stringify(param);\n        }\n        request({\n            url: url,\n            headers: {\n                'Authorization': 'OAuth2 ' + access_token\n            }\n        }, function (err, resp, body) {\n            if (err) return cb(new Error('请求失败: ' + err));\n            // handle server errors\n            if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n                return cb(new Error('服务器内部错误: (' + resp.statusCode + ') ' + body));\n            }\n            var response = JSON.parse(body);\n            if (response.error_code) {\n                return cb(new Error(`请求失败: ${response.error}`))\n            } else {\n                return cb(null, response);\n            }\n        })\n    }\n\n    revisions({access_token,path}={}, cb) {\n        request({\n            url: this.API_URL + 'revisions/' + this.root + \"/\" + path,\n            headers: {\n                'Authorization': 'OAuth2 ' + access_token\n            }\n        }, function (err, resp, body) {\n            if (err) return cb(new Error('请求失败: ' + err));\n            // handle server errors\n            if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n                return cb(new Error('服务器内部错误: (' + resp.statusCode + ') ' + body));\n            }\n            var response = JSON.parse(body);\n            if (response.error_code) {\n                return cb(new Error(`请求失败: ${response.error}`))\n            } else {\n                return cb(null, response);\n            }\n        })\n    }\n\n    /**\n     * Save files\n     * @param access_token\n     * @param path\n     * @param files\n     * @param overwrite\n     * @param sha1\n     * @param size\n     * @param parent_rev\n     * @param cb\n     */\n    saveFiles({access_token,path=\"\",files,overwrite = \"true\",sha1 = \"\",size = \"\", parent_rev = \"\"}={}, cb) {\n        let param = {\n            access_token: access_token,\n            overwrite: overwrite\n        };\n        if (sha1.length > 0) param[\"sha1\"] = sha1;\n        if (size.length > 0) param[\"size\"] = size;\n        if (parent_rev.length > 0) param[\"parent_rev\"] = parent_rev;\n\n        let queries = querystring.stringify(param);\n\n        let url = this.CONTENT_SAFE_URL + 'files/' + this.root + \"/\" + path + \"?\" + queries;\n\n        let formData = {\n            file: fs.createReadStream(files)\n        };\n\n        request.post({\n            rejectUnauthorized: false,\n            url: url,\n            formData: formData\n        }, function (err, resp, body) {\n            if (err) return cb(new Error('请求失败: ' + err));\n            // handle server errors\n            if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n                return cb(new Error('服务器内部错误: (' + resp.statusCode + ') ' + body));\n            }\n            var response = JSON.parse(body);\n            if (response.error_code) {\n                return cb(new Error(`请求失败: ${response.error}`))\n            } else {\n                return cb(null, response);\n            }\n        });\n    }\n\n    /**\n     * Update files\n     * @param access_token\n     * @param path\n     * @param files\n     * @param overwrite\n     * @param sha1\n     * @param size\n     * @param parent_rev\n     * @param cb\n     */\n    updateFiles({access_token,path,files,overwrite = \"true\",sha1 = \"\",size = \"\", parent_rev = \"\"}={}, cb) {\n\n        let param = {\n            \"access_token\": access_token,\n            \"overwrite\": overwrite\n        };\n        if (sha1.length > 0)  param[\"sha1\"] = sha1;\n        if (size.length > 0) param[\"size\"] = size;\n        if (parent_rev.length > 0) param[\"parent_rev\"] = parent_rev;\n\n        let host = this.UPLOAD_HOST,\n            api = '/2/files_put/' + this.root + \"/\" + path + \"?\" + querystring.stringify(param);\n        let url = 'http://' + host + api;\n\n        let formData = {\n            file: fs.createReadStream(files)\n        };\n\n        request.put({\n            rejectUnauthorized: false,\n            url: url,\n            formData: formData\n        }, function (err, resp, body) {\n            if (err) return cb(new Error('请求失败: ' + err));\n            // handle server errors\n            if (resp.statusCode >= 500 && resp.statusCode <= 599) {\n                return cb(new Error('服务器内部错误: (' + resp.statusCode + ') ' + body));\n            }\n            var response = JSON.parse(body);\n            if (response.error_code) {\n                return cb(new Error(`请求失败: ${response.error}`))\n            } else {\n                return cb(null, response);\n            }\n        })\n    }\n\n}\n\nexports.OAuth2 = OAuth2;\nexports.Client = Client;"],"sourceRoot":"/source/"}